<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>积分规则</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="plugins/layui/css/layui.css" media="all" />
		<link rel="stylesheet" href="css/global.css" media="all">
		<link rel="stylesheet" href="css/reset.css" media="all">
	</head>
	<body>
	   <div class="container" style="width: 70%;">	
		 <div style="margin: 15px;">
		      <span class="layui-breadcrumb">
				  <a>积分管理</a>
				  <a><cite>积分规则</cite></a>
			  </span>
		 </div>
		 
		 <div class="layui-form" style="margin: 17px;">
		      <div class="layui-form-item">
		      	  <textarea id="content" style="display: none;"></textarea>
		      </div>
		   </div>
		   
		    <div style="margin-left:43%;margin-bottom: 30px;">
		    	<button class="layui-btn layui-btn-big" id="postdata">提交</button>
		    </div>
		 </div>
		 <script type="text/javascript" src="js/jquery.min.js"></script>
		 <script type="text/javascript" src="plugins/layui/layui.js"></script>
		 <script type="text/javascript" src="js/com.js"></script>
		  <script>
		  	       var scoreRule,active,index;
		  	    
		  	        layui.use(['layedit','form','upload'], function(){
					   var layedit = layui.layedit;
					   var form = layui.form();
					 
					   active = {
							    content: function(){
							      scoreRule = layedit.getContent(index); //获取编辑器内容
							    }
							    ,text: function(){
							      scoreRule = layedit.getText(index); //获取编辑器纯文本内容
							    }
							    ,selection: function(){
							      scoreRule = layedit.getSelection(index);
							    }
							  };
					     
					      function getdata(data){
					    	var data = JSON.parse(JSON.stringify(data));
					    	if(data.return){
					    		var sR = data.scoreRule;
					    		$("#content").val(sR);
					    		index = layedit.build('content'); //建立编辑器
					    	}
					    }
					     
					    postRemote("user/appInfoServlet.do?flag=getScoreRule3_0_1",{},getdata); 
					    
					    function postback(data){
					    	var data = JSON.parse(JSON.stringify(data));
					    	
					    	if(data.return){
					 	 	   	 layer.msg('您已成功设置规则', {icon: 1});
					 	 	   }else{
					 	 	   	   layer.msg('设置失败', {icon: 2});
					 	 	   }
			      }
					   
					  $(document).on('click',"#postdata",function(){
					  	      active.content();
					  	      console.log(scoreRule);
                              postRemote("user/appInfoServlet.do?flag=saveScoreRule3_0_1",{"scoreRule":scoreRule},postback);  
					      });
				 });
			</script>
	</body>
</html>
