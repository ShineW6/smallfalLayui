<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>比赛阶段分值设置</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="plugins/font-awesome/css/font-awesome.min.css" media="all" />
		<link rel="stylesheet" href="plugins/layui/css/layui.css" media="all" />
		<link rel="stylesheet" href="css/bootstrap-responsive.min.css" />
		<link rel="stylesheet" href="css/dataTables.jqueryui.min.css" />
		<link rel="stylesheet" href="css/global.css" media="all">
		<link rel="stylesheet" href="css/reset.css" media="all">
		<style>
			body{
				font-size: 62.5%;
			}
			.layui-form-label{
				font-size: 21px;
			}
			.tipspan{
				font-size: 12px;
				color: #CCC;
				margin-left:0px;
			}
		</style>
	</head>
	<body>
	   <div class="container" style="width:98%;margin: 0 auto;">	
		 <div style="margin: 15px;">
		      <span class="layui-breadcrumb">
				  <a>积分管理</a>
				  <a><cite>比赛阶段分值设置</cite></a>
			  </span>
		 </div>
		 
		 <div class="admin-main">
			<fieldset class="layui-elem-field">
				<legend>数据列表</legend>
				<div class="layui-field-box">
				   <div class="tableMarginDiv tableMargin">
				   	<form class="layui-form">
				   	  <div class="layui-form-item">
				   	    <div class="layui-inline">
					       <label class="layui-form-item" style="font-size: 20px;">比赛阶段分值设置</label>
					    </div>
					   </div>
				<table class="layui-table admin-table" id="matchScroeList-table">
				<thead>
					<th style="font-size: 17px;">设置部分</th>
					<th style="font-size: 17px;">数值</th>
					<th style="font-size: 17px;">操作</th>
				</thead>
				<tbody id='matchScroetable-Tbody'>
					<tr>
						<td>参赛分设置<br / ><span class="tipspan">(难度系数*该比赛自设分值*比赛系数=参与分)</span></td>
                        <td id="compeScore"></td>
                        <td><a class="layui-btn layui-btn-big" id="edit-compeScore">修改</a></td>
					</tr>
					<tr>
						<td>比赛阶段起始分值<br / ><span class="tipspan">(建议从1、2、3......开始设，一般起始阶段为初赛，如初赛分为1)</span></td>
                        <td id="startScore"></td>
                        <td><a class="layui-btn layui-btn-big" id="edit-startScore">修改</a></td>
					</tr>
					<tr>
						<td>每段赛程进程晋级增加分值<br / ><span class="tipspan">(建议每赛程之间递增分数为1、2、3......左右，如：初赛分为1，递增分数为1，半决赛分数则为2，下一赛程分值为3)</span></td>
                        <td id="addedScore"></td>
                        <td><a class="layui-btn layui-btn-big" id="edit-addedScore">修改</a></td>
					</tr>
				</tbody>
				</table>
				</from>
				   </div>
				</div>
			</fieldset>
		 </div>
		  <script type="text/javascript" src="js/jquery.min.js"></script>
		  <script type="text/javascript" src="plugins/layui/layui.js"></script>
		  <script type="text/javascript" src="js/jquery.dataTables.min.js" ></script>
		 <script type="text/javascript" src="js/com.js"></script>
		 <script>
		 	var layer;
		 	        function compeScoreCallback(data,postData){
		   	             var data = JSON.parse(JSON.stringify(data));
		   	             if(data.return){
								 		layer.msg('您已成功修改参赛分', {icon: 1});
			                			 $("#compeScore").text(postData.compeScore);
							 	    }else if(data.notLogin){
							 	    	layer.msg('您还未登录帐号，请先登录帐号', {icon: 2});
							 	    }else{
							 	    	layer.msg('操作失败。', {icon: 2});
							 	    }
		            }
			         
			        function startScoreCallback(data,postData){
		   	             var data = JSON.parse(JSON.stringify(data));
		   	             if(data.return){
								 		layer.msg('您已成功修改起始分', {icon: 1});
                                        $("#startScore").text(postData.startScore);  
							 	    }else if(data.notLogin){
							 	    	layer.msg('您还未登录帐号，请先登录帐号', {icon: 2});
							 	    }else{
							 	    	layer.msg('操作失败。', {icon: 2});
							 	    }
		            }
		 	        
		 	        function addedScoreCallback(data,postData){
		   	             var data = JSON.parse(JSON.stringify(data));
		   	             if(data.return){
								 		layer.msg('您已成功修改增加分', {icon: 1});
                                        $("#addedScore").text(postData.addedScore);  
							 	    }else if(data.notLogin){
							 	    	layer.msg('您还未登录帐号，请先登录帐号', {icon: 2});
							 	    }else{
							 	    	layer.msg('操作失败。', {icon: 2});
							 	    }
		            }
		   $(function(){
		   	 layui.use(['layer'], function() {
			 layer = layui.layer,
			   	$(document).on('click', '#edit-compeScore',function() {
	                           var con = '<div style="padding:10px;"><input type="text" class="layui-input" name="categoryName" placeholder="参赛分" required lay-verify="required" /></div>';
								      layer.open({
											type: 1,
											title: '修改参赛分',
											content: con,
											btn: ['确定', '取消'],
											area: ['350px', '175px'],
											yes: function(index, layero) {
												var postData = {
													compeScore : $(layero).find('input[name=categoryName]').val() //标签名
												}
												postRemote("platform/scoreConfigServlet.do?flag=setCompeScore3_4_1", postData , compeScoreCallback, postData);
	                                            layer.close(index);
											},
											shade :false,
											maxmin :true
										});				 		 	
				   	   	});
				
				 $(document).on('click', '#edit-startScore',function() {
                           var con = '<div style="padding:10px;"><input type="text" class="layui-input" name="categoryName" placeholder="起始分" required lay-verify="required" /></div>';
							      layer.open({
										type: 1,
										title: '修改起始分',	
										content: con,
										btn: ['确定', '取消'],
										area: ['350px', '175px'],
										yes: function(index, layero) {
											var postData = {
												startScore: $(layero).find('input[name=categoryName]').val() //标签名
											}
											postRemote("platform/scoreConfigServlet.do?flag=setStartScore3_4_1", postData , startScoreCallback, postData);
                                            layer.close(index);
										},
										shade :false,
										maxmin :true
									});				 		 	
			   	   	});
			   	   	
			   	    $(document).on('click', '#edit-addedScore',function() {
                           var con = '<div style="padding:10px;"><input type="text" class="layui-input" name="categoryName" placeholder="增加分" required lay-verify="required" /></div>';
							      layer.open({
										type: 1,
										title: '修改增加分',	
										content: con,
										btn: ['确定', '取消'],
										area: ['350px', '175px'],
										yes: function(index, layero) {
											var postData = {
												addedScore: $(layero).find('input[name=categoryName]').val() //标签名
											}
											postRemote("platform/scoreConfigServlet.do?flag=setAddedScore3_4_1", postData , addedScoreCallback, postData);
                                            layer.close(index);
										},
										shade :false,
										maxmin :true
									});				 		 	
			   	   	});
			   	});
		   })
          		 
		   function finalScroeData(data,obj){
		   	    var matchScroe = JSON.parse(JSON.stringify(data));
		   	    var tableLayer = obj.layer;
		   	    var tableForm = obj.form;
		   	    $("#compeScore").text(matchScroe.compeScore);
                $("#startScore").text(matchScroe.startScore); 
                $("#addedScore").text(matchScroe.addedScore);
		   }
		   
		   function getFinalScroe(){
		 		layui.use(['layer', 'form'], function() {
				var layer = layui.layer,
					$ = layui.jquery,
					form = layui.form();
					postRemote("platform/scoreConfigServlet.do?flag=getScoreConfig3_4_1", {}, finalScroeData ,{"layer":layer,"form":form});
		 		});
		 	}
		   
		   
           $(function pageInit() {
            	
            getFinalScroe();
            
         });
        
		 	
			
        </script>
	</body>
</html>
